# Funkcja do obliczania średniej kolumny "Brutto" w plikach CSV z folderu Symulacje
oblicz_srednia_brutto <- function(sciezka_do_symulacji) {
  # Wczytaj listę plików CSV w folderze Symulacje
  pliki <- list.files(sciezka_do_symulacji, pattern = "*.csv", full.names = TRUE)
  
  # Tworzymy pustą listę, aby przechowywać wyniki
  wyniki <- lapply(pliki, function(plik) {
    # Odczytaj plik CSV
    dane <- read.csv(plik)
    
    # Sprawdź, czy kolumna Brutto istnieje
    if ("Brutto" %in% colnames(dane)) {
      # Oblicz średnią z kolumny Brutto
      srednia_brutto <- mean(dane$Brutto, na.rm = TRUE)
    } else {
      # Jeśli brak kolumny Brutto, ustaw NA
      srednia_brutto <- NA
    }
    
    # Zwróć nazwę pliku i średnią jako lista
    list(Ubezpieczyciel = basename(plik), srednia_brutto = srednia_brutto)
  })
  
  # Przekształć wyniki z listy na data.frame
  df <- do.call(rbind, lapply(wyniki, as.data.frame))
  
  return(df)
}

# Użycie funkcji:
# Zakładam, że sciezka_do_symulacji to ścieżka do folderu Symulacje
sciezka_do_symulacji <- "sciezka/do/twojego/folderu/Symulacje"
wynik_srednie_brutto <- oblicz_srednia_brutto(sciezka_do_symulacji)

# Zobacz wynikowy dataframe
print(wynik_srednie_brutto)
