log_memory <- function() {
  mem <- pryr::mem_used()
  cat(paste(Sys.time(), "Memory used:", mem, "\n"), file = "memory_log.txt", append = TRUE)
}

# Przykład użycia w symulacji:
for (i in 1:100) {
  x <- rnorm(1e6)  # Przykładowa operacja
  log_memory()
  rm(x)
  gc()  # Zwolnienie pamięci
}
