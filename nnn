load_csv_files <- function(folder_path) {
  # Pobierz listę plików CSV w folderze
  csv_files <- list.files(folder_path, pattern = "*.csv", full.names = TRUE)
  
  # Tworzymy pustą listę na dane
  data_list <- list()
  
  # Inicjujemy zliczanie postępu
  withProgress(message = 'Wczytywanie plików CSV...', value = 0, {
    # Przechodzimy przez wszystkie pliki CSV
    n <- length(csv_files)
    for (i in 1:n) {
      # Wczytujemy plik
      file <- csv_files[i]
      tryCatch({
        # Próba wczytania pliku
        data <- read.csv(file, fileEncoding = "UTF-8-BOM")
        # Dodajemy dane do listy
        data_list[[i]] <- data
        
        # Ustawiamy postęp
        incProgress(1/n, detail = paste("Wczytywanie pliku:", basename(file)))
      }, error = function(e) {
        # Obsługuje błąd i wyświetla komunikat
        message(paste("Błąd podczas wczytywania pliku:", file, "-", e))
      })
    }
  })
  
  # Przypisanie nazw dla plików
  names(data_list) <- gsub(".csv", "", basename(csv_files))
  
  # Zwracamy listę z danymi
  return(data_list)
}
