# Funkcja do obliczania stabilności odchylenia standardowego
compute_stability_sd <- function(data, steps) {
  sds <- sapply(1:steps, function(x) sd(data[1:x]))
  return(sds)
}

# Obliczenia dla odchylenia standardowego
stability_sd <- compute_stability_sd(simulations_data, steps)

# Rysowanie wykresów (dodajemy odchylenie standardowe jako trzeci wykres)
par(mfrow = c(1, 3))  # Trzy wykresy obok siebie

# Wykres 1: Stabilność średniej
plot(1:steps, stability_incremental$mean_values, type = "l", col = "blue", 
     xlab = "Liczba symulacji", ylab = "Średnia", main = "Stabilność średniej")

# Wykres 2: Stabilność kwantyla 0.995
plot(1:steps, stability_incremental$quantile_values, type = "l", col = "red", 
     xlab = "Liczba symulacji", ylab = "Kwantyl 0.995", main = "Stabilność kwantyla 0.995")

# Wykres 3: Stabilność odchylenia standardowego
plot(1:steps, stability_sd, type = "l", col = "green", 
     xlab = "Liczba symulacji", ylab = "Odchylenie standardowe", main = "Stabilność odchylenia standardowego")
