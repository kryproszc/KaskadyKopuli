library(shiny)

# UI aplikacji
ui <- fluidPage(
  titlePanel("Dynamiczny Slider"),
  
  sidebarLayout(
    sidebarPanel(
      fileInput("file", "Wczytaj dane (plik CSV):"),
      sliderInput("dynamic_slider", "Wybierz zakres:", 
                  min = 0, max = 10, value = c(2, 8)) # Domyślny slider
    ),
    
    mainPanel(
      textOutput("slider_values"),
      tableOutput("data_preview")
    )
  )
)

# Serwer aplikacji
server <- function(input, output, session) {
  # Przechowywanie danych
  data <- reactive({
    req(input$file) # Wymaga wczytania pliku
    read.csv(input$file$datapath)
  })
  
  # Aktualizacja slidera po wczytaniu danych
  observe({
    req(data()) # Czeka, aż dane zostaną wczytane
    
    # Wyciąganie minimalnej i maksymalnej wartości z danych
    min_val <- min(data()[[1]], na.rm = TRUE)
    max_val <- max(data()[[1]], na.rm = TRUE)
    
    # Aktualizacja zakresu slidera
    updateSliderInput(session, "dynamic_slider", 
                      min = min_val, 
                      max = max_val, 
                      value = c(min_val, max_val))
  })
  
  # Wyświetlanie wartości slidera
  output$slider_values <- renderText({
    paste("Wybrany zakres:", paste(input$dynamic_slider, collapse = " - "))
  })
  
  # Podgląd danych
  output$data_preview <- renderTable({
    head(data(), 5) # Wyświetla pierwsze 5 wierszy danych
  })
}

# Uruchomienie aplikacji
shinyApp(ui = ui, server = server)
